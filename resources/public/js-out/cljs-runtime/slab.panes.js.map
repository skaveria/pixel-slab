{"version":3,"sources":["slab/panes.cljs"],"mappings":"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","names":["slab.panes/token-test","cljs.core/re-pattern","slab.panes/token-repl","slab.panes/apply-template","tmpl","state","cljs.core/not","cljs.core/re-find","clojure.string/replace","p__6078","vec__6084","cljs.core.nth","_","k","v","slab.panes/classify-value","t","clojure.string/lower-case","clojure.string/includes?","slab.panes/split-kv","line","vec__6087","seq__6088","cljs.core/seq","first__6089","cljs.core/first","cljs.core/next","more","clojure.string.split","clojure.string/trim","clojure.string.join","temp__5804__auto__","vec__6090","cljs.core/re-matches","var_args","G__6095","slab.panes/mk-el","js/Error","tag","js/document","class-name","e","slab.panes/set-text!","el","s","slab.panes/append!","parent","child","slab.panes/mount-pane!","pre","cljs.core._EQ_","vec__6100","raw","clojure.string/trimr","lines","cljs.core.map","cljs.core.into","pane-type","clojure.string/starts-with?","cljs.core.subs","cljs.core.subvec","non-empty","p1__6097#","cljs.core.filter","kv-pairs","cljs.core/some?","is-kv","cljs.core/count","x__5087__auto__","y__5088__auto__","js/Math.floor","kv","slab.panes.mk_el","seq__6110","chunk__6111","count__6112","i__6113","vec__6126","cljs.core/chunked-seq?","c__5525__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","vec__6129","row","kdiv","vdiv","slab.panes/mount-all-panes!","seq__6137","chunk__6138","count__6139","i__6140","cljs.core.array_seq","slab.panes/render-panes!","seq__6141","chunk__6142","count__6143","i__6144","kind","seq__6164","chunk__6165","count__6166","i__6167","seq__6172","chunk__6173","count__6174","i__6175","rendered","klass"],"sourcesContent":["(ns slab.panes\n  (:require [clojure.string :as str]))\n\n(def token-test (re-pattern \"\\\\{\\\\{[a-zA-Z0-9_]+\\\\}\\\\}\"))\n(def token-repl (re-pattern \"\\\\{\\\\{([a-zA-Z0-9_]+)\\\\}\\\\}\"))\n\n(defn apply-template [tmpl state]\n  (let [tmpl (str tmpl)]\n    (if-not (re-find token-test tmpl)\n      tmpl\n      (str/replace tmpl token-repl\n                   (fn [[_ k]]\n                     (let [v (when state (aget state k))]\n                       (if (or (nil? v) (undefined? v)) \"\" (str v))))))))\n\n(defn classify-value [v]\n  (let [t (-> (str v) str/lower-case)]\n    (cond\n      (or (str/includes? t \"error\")\n          (str/includes? t \"failed\")\n          (str/includes? t \"offline\")\n          (str/includes? t \"down\")) \"bad\"\n      (or (str/includes? t \"warn\")\n          (str/includes? t \"charging\")\n          (str/includes? t \"dirty\")\n          (str/includes? t \"throttl\")\n          (str/includes? t \"hot\")) \"warn\"\n      :else \"\")))\n\n(defn split-kv [line]\n  (cond\n    (str/includes? line \"::\")\n    (let [[k & more] (str/split line #\"::\")]\n      [(str/trim k) (str/trim (str/join \"::\" more))])\n\n    :else\n    (when-let [[_ k v] (re-matches #\"^\\s*([^\\s]+)\\s{2,}(.+)$\" line)]\n      [(str/trim k) (str/trim v)])))\n\n;; ------------------------------------------------------------\n;; DOM helpers\n;; ------------------------------------------------------------\n\n(defn- mk-el\n  ([tag] (.createElement js/document tag))\n  ([tag class-name]\n   (let [e (.createElement js/document tag)]\n     (set! (.-className e) class-name)\n     e)))\n\n(defn- set-text! [el s]\n  (set! (.-textContent el) (str s))\n  el)\n\n(defn- append! [parent child]\n  (.appendChild parent child)\n  parent)\n\n;; ------------------------------------------------------------\n;; Pane mount/render\n;; ------------------------------------------------------------\n\n(defn mount-pane! [pre]\n  (when-not (= \"1\" (.getAttribute pre \"data-slab-mounted\"))\n    (.setAttribute pre \"data-slab-mounted\" \"1\")\n\n    (let [raw (-> (.-textContent pre) (str/replace #\"\\r\\n\" \"\\n\") (str/trimr))\n          lines (->> (str/split raw #\"\\n\") (map str/trimr) (into []))\n\n          [pane-type lines] (if (and (seq lines) (str/starts-with? (first lines) \"@\"))\n                              [(-> (subs (first lines) 1) str/trim str/lower-case)\n                               (subvec lines 1)]\n                              [nil lines])\n\n          _ (when pane-type\n              (.. pre -classList (add (str \"pane-\" pane-type))))\n\n          non-empty (->> lines (filter #(seq (str/trim %))) (into []))\n          kv-pairs (->> non-empty (map split-kv) (filter some?) (into []))\n          is-kv (>= (count kv-pairs) (max 1 (js/Math.floor (* 0.7 (count non-empty)))))]\n\n      (if-not is-kv\n        (do\n          (.setAttribute pre \"data-pane-kind\" \"text\")\n          (.setAttribute pre \"data-template\" (str/join \"\\n\" lines)))\n        (do\n          (.setAttribute pre \"data-pane-kind\" \"kv\")\n          (.. pre -classList (add \"pane-kv\"))\n\n          (let [kv (mk-el \"div\")]\n            (set! (.-className kv) \"kv\")\n\n            (doseq [[k v] kv-pairs]\n              (let [row (mk-el \"div\" \"row\")\n                    kdiv (mk-el \"div\" \"k\")\n                    vdiv (mk-el \"div\" \"v\")]\n                (set-text! kdiv k)\n                (.setAttribute vdiv \"data-template\" v)\n                (set-text! vdiv v)\n                (append! row kdiv)\n                (append! row vdiv)\n                (append! kv row)))\n\n            (set! (.-textContent pre) \"\")\n            (append! pre kv)))))))\n\n(defn mount-all-panes! []\n  (doseq [pre (array-seq (.querySelectorAll js/document \"pre.example\"))]\n    (mount-pane! pre)))\n\n(defn render-panes! [state]\n  (doseq [pre (array-seq (.querySelectorAll js/document \"pre.example\"))]\n    (let [kind (.getAttribute pre \"data-pane-kind\")]\n      (cond\n        (= kind \"text\")\n        (let [tmpl (.getAttribute pre \"data-template\")]\n          (set! (.-textContent pre) (apply-template tmpl state)))\n\n        (= kind \"kv\")\n        (doseq [vdiv (array-seq (.querySelectorAll pre \".v\"))]\n          (let [tmpl (.getAttribute vdiv \"data-template\")\n                rendered (apply-template tmpl state)\n                klass (classify-value rendered)]\n            (set! (.-textContent vdiv) rendered)\n            (.. vdiv -classList (remove \"warn\"))\n            (.. vdiv -classList (remove \"bad\"))\n            (when (seq klass)\n              (.. vdiv -classList (add klass)))))))))\n"]}