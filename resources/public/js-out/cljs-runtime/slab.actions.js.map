{"version":3,"sources":["slab/actions.cljs"],"mappings":";AAKA,+BAAA,uCAAAA,tEAAMI;AAAN,AAAA,IAAAH,YAAAD;IAAAC,gBAAA,AAAAC,4BAAAD;SAAA,AAAAE,4CAAAF,cAAA,/DAA0BI;AAA1B,AACE,IAAMC,OAAK,AAACC,uBAAkBF;IACxBG,OAAK,AAACC,kCAAwBH,KAAKD;AADzC,AAEE,oBAAMG;AAAN,AACE,AAACE,4BAAkBF;;OACf,AAACG,yBAAeL,zBAChB,oCAAO,WAAKM,tDAKZ;AALO,AACE,IAAAC,UAAM,AAAA,mFAAOD;IAAbC,cAAA,EAAA,CAAAA,mBAAAC,oBAAA,AAAAD,YAAA;AAAA,AAAA,QAAAA;KAAA;AACQ,OAACE,yBAAeP,KAAKI;;;KAD7B;AAEQ,OAACI,yBAAeR,KAAKI;;;;AAC3B,qCAAA,2CAAA,zEAACG,yBAAeP,sGAAY,AAACS,wGAAOL;;;UACvC,WAAKM;AAAL,AACE,OAACC,0BAAgBX,KAAKU;;;AATtC;;;AAWJ,uBAAA,2CAAA,lEAAeE,gIACDhB;AAEd,8BAAA,sCAAAiB,pEAAME;AAAN,AAAA,IAAAD,YAAAD;IAAAC,gBAAA,AAAApB,4BAAAoB;UAAAA,NAAqCG;aAArC,AAAAtB,4CAAAmB,cAAA,nEAAyBE;AAAzB,AACE,IAAAE,qBAAW,AAACvB,4CAAIiB,qBAAQI;AAAxB,AAAA,oBAAAE;AAAA,QAAAA,JAASC;AAAT,AACE,QAACA,kCAAAA,uCAAAA,PAAEF,mBAAAA;;AACH,oBAAA,bAACG,+BAAkC,AAACC,eAAKL,QAAQC","names":["p__6119","map__6120","cljs.core/--destructure-map","cljs.core.get","slab.actions/run-token!","el","info","slab.tokens/token-info","slot","slab.dom/ensure-output-slot!","slab.dom/show-loading!","slab.net/run-token!","resp","G__6121","cljs.core/Keyword","slab.dom/show-text!","slab.dom/show-rich!","cljs.core.pr_str","e","slab.dom/show-error!","slab.actions/actions","p__6122","map__6123","slab.actions/dispatch!","action","ctx","temp__5802__auto__","f","js/console.warn","cljs.core/name"],"sourcesContent":["(ns slab.actions\n  (:require [slab.tokens :as tokens]\n            [slab.dom :as dom]\n            [slab.net :as net]))\n\n(defn run-token! [{:keys [el]}]\n  (let [info (tokens/token-info el)\n        slot (dom/ensure-output-slot! info el)]\n    (when slot\n      (dom/show-loading! slot)\n      (-> (net/run-token! info)\n          (.then (fn [resp]\n                   (case (:type resp)\n                     :text (dom/show-text! slot resp)\n                     :rich (dom/show-rich! slot resp)\n                     (dom/show-text! slot {:body (pr-str resp)}))))\n          (.catch (fn [e]\n                    (dom/show-error! slot e)))))))\n\n(def ^:private actions\n  {:run-token run-token!})\n\n(defn dispatch! [{:keys [action] :as ctx}]\n  (if-let [f (get actions action)]\n    (f ctx)\n    (js/console.warn \"Unknown action:\" (name action) ctx)))\n"]}