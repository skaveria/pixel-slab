{"version":3,"sources":["slab/actions.cljs"],"mappings":";AAMA,+BAAA,uCAAAA,tEAAMI;AAAN,AAAA,IAAAH,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;SAAA,AAAAE,4CAAAF,eAAA,hEAA0BI;AAA1B,AACE,IAAMC,OAAK,AAACC,uBAAkBF;IACxBG,OAAK,AAACC,kCAAwBH;AADpC,AAEE,oBAAME;AAAN,AACE,AAACE,4BAAkBF;;OACf,AAACG,yBAAeL,zBAChB,oCAAO,WAAKM,tDAMZ;AANO,AACE,IAAAC,WAAM,AAAA,mFAAOD;IAAbC,eAAA,EAAA,CAAAA,oBAAAC,oBAAA,AAAAD,aAAA;AAAA,AAAA,QAAAA;KAAA;AACQ,OAACE,yBAAeP,KAAKI;;;KAD7B;AAEQ,OAACI,yBAAeR,KAAKI;;;;AAE3B,qCAAA,2CAAA,zEAACG,yBAAeP,sGAAY,AAACS,wGAAOL;;;UACvC,WAAKM;AAAL,AACE,OAACC,0BAAgBX,KAAKU;;;AAVtC;;;AAYJ,uBAAA,2CAAA,lEAAeE,gIACDhB;AAEd,8BAAA,sCAAAiB,pEAAME;AAAN,AAAA,IAAAD,aAAAD;IAAAC,iBAAA,AAAApB,4BAAAoB;UAAAA,NAAqCG;aAArC,AAAAtB,4CAAAmB,eAAA,pEAAyBE;AAAzB,AACE,IAAAE,qBAAW,AAACvB,4CAAIiB,qBAAQI;AAAxB,AAAA,oBAAAE;AAAA,QAAAA,JAASC;AAAT,AACE,QAACA,kCAAAA,uCAAAA,PAAEF,mBAAAA;;AACH,oBAAA,bAACG,+BAAkC,AAACC,eAAKL,QAAQC","names":["p__22037","map__22038","cljs.core/--destructure-map","cljs.core.get","slab.actions/run-token!","el","info","slab.tokens/token-info","slot","slab.dom/ensure-output-slot!","slab.dom/show-loading!","slab.net/run-token!","resp","G__22039","cljs.core/Keyword","slab.dom/show-text!","slab.dom/show-rich!","cljs.core.pr_str","e","slab.dom/show-error!","slab.actions/actions","p__22040","map__22041","slab.actions/dispatch!","action","ctx","temp__5802__auto__","f","js/console.warn","cljs.core/name"],"sourcesContent":[";; src-cljs/slab/actions.cljs\n(ns slab.actions\n  (:require [slab.tokens :as tokens]\n            [slab.dom :as dom]\n            [slab.net :as net]))\n\n(defn run-token! [{:keys [el]}]\n  (let [info (tokens/token-info el)\n        slot (dom/ensure-output-slot! info)]\n    (when slot\n      (dom/show-loading! slot)\n      (-> (net/run-token! info)\n          (.then (fn [resp]\n                   (case (:type resp)\n                     :text (dom/show-text! slot resp)\n                     :rich (dom/show-rich! slot resp)\n                     ;; unknown type: render the whole response as text\n                     (dom/show-text! slot {:body (pr-str resp)}))))\n          (.catch (fn [e]\n                    (dom/show-error! slot e)))))))\n\n(def ^:private actions\n  {:run-token run-token!})\n\n(defn dispatch! [{:keys [action] :as ctx}]\n  (if-let [f (get actions action)]\n    (f ctx)\n    (js/console.warn \"Unknown action:\" (name action) ctx)))\n"]}