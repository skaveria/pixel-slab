{"version":3,"sources":["slab/config.cljs"],"mappings":";AAIA,sBAAA,tBAAKA;AAML,2BAAA,3BAAKC;AAEL,2BAAA,mFAAA,2CAAA,qDAAA,aAAA,uDAAA,oBAAA,2CAAA,qDAAA,cAAA,uDAAA,iBAAA,2CAAA,qDAAA,WAAA,uDAAA,cAAA,2CAAA,qDAAA,aAAA,uDAAA,gBAAA,2CAAA,qDAAA,aAAA,uDAAA,gBAAA,2CAAA,qDAAA,aAAA,uDAAA,gBAAA,2CAAA,qDAAA,aAAA,uDAAA,50CAAKC;AASL,GAAA,QAAAC,iCAAAC,wCAAAC;AAAA;AAAA,AAAA,AAASC,2BAAQ,6CAAA,2CAAA,6EAAA,rKAACC,4IAAYN,8EAAmBC;;AAMjD,uBAAA,vBAAMM,sDAAUC;AAAhB,AACE,IAAMA,QAAE,iBAAAC,mBAAID;AAAJ,AAAA,oBAAAC;AAAAA;;AAAA;;;IACFD,QAAE,AAACE,gBAAM,yDAAA,zDAACC,mDAAUH;IACpBI,QAAM,yDAAA,zDAACD,mDAAUH;AAFvB,AAGE,IAAAC,mBAAI,AAACI,eAAKD;AAAV,AAAA,oBAAAH;AAAAA;;AAAA;;;AAEJ,gCAAA,hCAAMK;AAAN,AACE,IAAMC,QAAM,AAAYC;IAClBC,IAAE,AAAYD;AADpB,AAEE,GACE,mDAAA,nDAACE,6CAAEH;AAAe,OAACR,qBAASU;;AAD9B,GAEE,EAAI,MAAA,LAAMA,gBAAG,+CAAA,/CAACC,6CAAED;AAFlB;;AAAA,AAGQ,OAACV,qBAASU;;;;;AAEtB,wBAAA,xBAAOE,wDAAWC;AAAlB,qDACMA,vBACA,gCAAA,UAAA,1CAACC,9BACD,4EAAA,SAAA,9EAACA;;AAEP,yBAAA,zBAAMC,0DAAYC;AAAlB,AACE,IAAMC,OAAK,AAAA,mFAAA,AAAAC,gBAAQpB;AAAnB,AACE,IAAAI,mBAAI,AAAA,qFAAQ,AAACC,gBAAM,+CAAA,WAAAgB,1DAACC;AAAD,AAAS,OAACT,6CAAE,AAAA,mFAAAQ,iBAAUH;GAAMC;AAA/C,AAAA,oBAAAf;AAAAA;;AACI,OAACU,sBAAUI;;;AAMnB,+BAAA,/BAAMK;AAAN,AAEE,GAAI,6CAAA,7CAACV,qDAAU,AAAYF;AACzB,uBAAA,hBAACa;;OACG,MAAA,NAACC,kBAAqB,qBAAA,2CAAA,wDAAA,xHAACC,lBACvB,oKAAO,WAAKC,/KACZ,PAMA;AAPO,AAAU,oBAAI,AAAMA;AAAK,OAAOA;;AAAtB;;SACV,WAAKC;AAAL,AACE,oBAAM,iBAAAC,oBAAKD;AAAL,AAAA,oBAAAC;AAAS,OAACC,cAAI,AAACC,oBAASH;;AAAxBC;;;AAAN,AACE,IAAMG,IAAE,AAACC,sDAAmBL;AAA5B,AACE,sDAAA,2CAAA,1FAACM,sBAAOlC,wHACO,iBAAAI,mBAAI,AAAA,kFAAO4B;AAAX,AAAA,oBAAA5B;AAAAA;;AAAcT;;KAD7B,qDAEe,iBAAAS,mBAAI,AAAA,mFAAO4B;AAAX,AAAA,oBAAA5B;AAAAA;;AAAcR;;;;AAJjC;;UAKD,WAAKuC;AAAL,AAAA","names":["slab.config/poll-ms","slab.config/default-node","slab.config/default-tabs","js/slab","js/slab.config","js/slab.config.chrome*","slab.config/chrome*","cljs.core.atom","slab.config/basename","s","or__5002__auto__","cljs.core/first","clojure.string.split","parts","cljs.core/last","slab.config/current-page-name","proto","js/location","p","cljs.core._EQ_","slab.config/file-stem","filename","clojure.string/replace","slab.config/page-label","page","tabs","cljs.core/deref","p1__6093#","cljs.core.filter","slab.config/fetch-tabs!","js/Promise.resolve","js/fetch","cljs.core/clj->js","res","txt","and__5000__auto__","cljs.core/seq","clojure.string/trim","m","cljs.reader.read_string","cljs.core/reset!","_"],"sourcesContent":["(ns slab.config\n  (:require [clojure.string :as str]\n            [cljs.reader :as reader]))\n\n(def poll-ms 2500)\n\n;; ------------------------------------------------------------\n;; Defaults + runtime config (tabs.edn)\n;; ------------------------------------------------------------\n\n(def default-node \"slab-01\")\n\n(def default-tabs\n  [{:href \"index.html\"  :label \"dashboard\"}\n   {:href \"system.html\" :label \"system\"}\n   {:href \"git.html\"    :label \"git\"}\n   {:href \"event.html\"  :label \"event\"}\n   {:href \"notes.html\"  :label \"notes\"}\n   {:href \"about.html\"  :label \"about\"}\n   {:href \"media.html\"  :label \"media\"}])\n\n(defonce chrome* (atom {:node default-node :tabs default-tabs}))\n\n;; ------------------------------------------------------------\n;; Small helpers\n;; ------------------------------------------------------------\n\n(defn basename [s]\n  (let [s (or s \"\")\n        s (first (str/split s #\"[?#]\"))\n        parts (str/split s #\"/\")]\n    (or (last parts) \"index.html\")))\n\n(defn current-page-name []\n  (let [proto (.-protocol js/location)\n        p (.-pathname js/location)]\n    (cond\n      (= proto \"file:\") (basename p)\n      (or (nil? p) (= p \"/\")) \"index.html\"\n      :else (basename p))))\n\n(defn- file-stem [filename]\n  (-> filename\n      (str/replace #\"\\.html$\" \"\")\n      (str/replace #\"\\.htm$\"  \"\")))\n\n(defn page-label [page]\n  (let [tabs (:tabs @chrome*)]\n    (or (:label (first (filter #(= (:href %) page) tabs)))\n        (file-stem page))))\n\n;; ------------------------------------------------------------\n;; Load tabs.edn (editable tabs config)\n;; ------------------------------------------------------------\n\n(defn fetch-tabs! []\n  ;; file:// dev mode: keep defaults\n  (if (= \"file:\" (.-protocol js/location))\n    (js/Promise.resolve nil)\n    (-> (js/fetch \"/tabs.edn\" (clj->js {:cache \"no-store\"}))\n        (.then (fn [res] (if (.-ok res) (.text res) nil)))\n        (.then (fn [txt]\n                 (when (and txt (seq (str/trim txt)))\n                   (let [m (reader/read-string txt)]\n                     (reset! chrome*\n                             {:node (or (:node m) default-node)\n                              :tabs (or (:tabs m) default-tabs)})))))\n        (.catch (fn [_] nil)))))\n"]}