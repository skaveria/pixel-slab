{"version":3,"sources":["slab/events.cljs"],"mappings":";AAKA,GAAA,QAAAA,iCAAAC,wCAAAC;AAAA;AAAA,AAAA,AAAmBC,+BAAW,6CAAA,7CAACC;;AAE/B;;;6BAAA,7BAAOC,kEAEAC;AAFP,AAGE,IAAOC,KAAGD;;AAAV,AACE,GACE,OAAA,NAAMC;AADR;;AAAA,oBAEE,qBAAA,rBAACC,kBAAUD;AAAiBA;;AAF9B,AAGQ,cAAO,AAAiBA;;;;;;;;;AAEpC,uBAAA,vBAAOE,sDAAcC;AAArB,AACE,IAAMH,KAAG,AAACF,2BAAe,AAAUK;IAC7BC,SAAO,AAACC,aAAK,qBAAA,rBAACJ,kBAAUD;AAD9B,AAEE,oBAAMI;AAAN,AACE,AAAiBD;;AACjB,mCAAA,2CAAA,gEAAA,qDAAA,5LAACG,gIAA2BF,yDAAWJ,yDAAUG;;AAFnD;;;AAIJ,2BAAA,3BAAMI;AAAN,AAEE,oBAAA,AAAAC,gBAAWZ;AAAX;;AAAA,AACE,0BAAA,1BAAmBa,kCAAoBP;;AACvC,0DAAA,nDAACQ,sBAAOd;;;AAEZ,2BAAA,3BAAMe;AAAN,AAEE,oBAAA,AAAAH,gBAAOZ;AAAP,AACE,6BAAA,7BAAsBa,qCAAoBP;;AAC1C,0DAAA,nDAACQ,sBAAOd;;AAFV","names":["js/slab","js/slab.events","js/slab.events.installed?","slab.events/installed?","cljs.core.atom","slab.events/find-action-el","target","el","slab.util/dataset","slab.events/on-click","e","action","slab.util/kw","slab.actions/dispatch!","slab.events/attach!","cljs.core/deref","js/document","cljs.core/reset!","slab.events/detach!"],"sourcesContent":[";; src-cljs/slab/events.cljs\n(ns slab.events\n  (:require [slab.util :as u]\n            [slab.actions :as actions]))\n\n(defonce ^:private installed? (atom false))\n\n(defn- find-action-el\n  \"Walk up from target to find an element with data-slab-action.\"\n  [^js target]\n  (loop [el target]\n    (cond\n      (nil? el) nil\n      (u/dataset el \"slabAction\") el\n      :else (recur (.-parentElement el)))))\n\n(defn- on-click [^js e]\n  (let [el (find-action-el (.-target e))\n        action (u/kw (u/dataset el \"slabAction\"))]\n    (when action\n      (.preventDefault e)\n      (actions/dispatch! {:action action :el el :event e}))))\n\n(defn attach!\n  []\n  (when-not @installed?\n    (.addEventListener js/document \"click\" on-click)\n    (reset! installed? true)))\n\n(defn detach!\n  []\n  (when @installed?\n    (.removeEventListener js/document \"click\" on-click)\n    (reset! installed? false)))\n"]}