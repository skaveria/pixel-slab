/* SlabOS — Pixel-first battlestation CSS for Org HTML export
   WM inspiration: i3/sway/polybar + terminal culture
   Mapping:
     h1            -> top system bar
     h1 + p        -> workspace strip (horizontal scroll)
     h2            -> section header blocks
     pre.example   -> terminal panes (Org #+begin_example), enhanced by slab.js
     body > p:last -> modeline
*/

:root{
  /* Canvas */
  --bg: #0b0d0f;
  --plane-1: #0e1115;
  --plane-2: #101317;
  --block: #0f1216;
  --line: #1c2128;

  /* Palette */
  --fg: #f8f8f2;
  --muted: #9aa3ad;
  --dim: #757d86;

  --green: #a6e22e;
  --cyan: #66d9ef;
  --orange: #fd971f;
  --pink: #f92672;

  /* Geometry */
  --padx: 1.9rem;
  --topbar-h: 72px;     /* room away from URL bar */
  --workbar-h: 44px;    /* single-line scroll tabs */
  --modeline-h: 44px;   /* readable */

  /* Rhythm */
  --content-gap-top: 22px;
  --section-gap: 22px;

  /* Typography */
  --font: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "DejaVu Sans Mono", monospace;
}

/* Make height + padding cooperate everywhere */
* { box-sizing: border-box; }

html, body{
  height:100%;
  margin:0;
  background: var(--bg) !important;
  color: var(--fg) !important;
}

body{
  font-family: var(--font);
  letter-spacing: 0.2px;
  line-height: 1.35;
  -webkit-font-smoothing: antialiased;
  text-rendering: geometricPrecision;

  /* reserve space for fixed bars + modeline */
  padding-top: calc(var(--topbar-h) + var(--workbar-h) + var(--content-gap-top));
  padding-bottom: calc(var(--modeline-h) + 18px);

  /* curved screen padding */
  padding-left: var(--padx);
  padding-right: var(--padx);
}

/* unify safe-area math with non-safe-area branch */
@supports (padding: env(safe-area-inset-left)){
  body{
    padding-left: calc(var(--padx) + env(safe-area-inset-left));
    padding-right: calc(var(--padx) + env(safe-area-inset-right));
    padding-top: calc(var(--topbar-h) + var(--workbar-h) + var(--content-gap-top) + env(safe-area-inset-top));
    padding-bottom: calc(var(--modeline-h) + 18px + env(safe-area-inset-bottom));
  }
}

/* Links */
a{ color: var(--cyan); text-decoration:none; }
a:hover{ color: var(--green); }
a:active{ color: var(--orange); }

/* Selection */
::selection{ background: rgba(166,226,46,0.22); }

/* Hide Org TOC if anything sneaks in */
#table-of-contents, .toc, .org-ul.toc { display:none !important; }

/* ---------- TOP SYSTEM BAR (h1) ---------- */

h1{
  position: fixed;
  top:0; left:0; right:0;
  z-index: 200;

  margin:0;
  height: var(--topbar-h);
  display:flex;
  align-items:center;

  /* real breathing room */
  padding: 18px calc(var(--padx) + env(safe-area-inset-left)) 14px;

  background: rgba(16,19,23,0.98);
  border-bottom: 1px solid var(--line);

  font-size: 22px;
  font-weight: 800;
  letter-spacing: 0.02em;
  text-transform: lowercase;
  color: var(--green);
}

/* subtle cursor block like a terminal */
h1::after{
  content:"";
  width:10px;
  height:18px;
  margin-left:12px;
  background: var(--green);
  transform: translateY(2px);
  animation: blink 1.1s step-end infinite;
}
@keyframes blink { 0%,45%{opacity:1} 46%,100%{opacity:0} }

/* ---------- WORKSPACE STRIP (h1 + p) ---------- */

h1 + p{
  position: fixed;
  top: var(--topbar-h);
  left:0; right:0;
  z-index: 190;

  margin:0;
  height: var(--workbar-h);
  display:flex;
  align-items:center;

  padding: 0 calc(var(--padx) + env(safe-area-inset-left));
  background: rgba(14,17,21,0.98);
  border-bottom: 1px solid var(--line);

  white-space: nowrap;
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;

  font-size: 15px;
}

/* hide scrollbar but keep scroll */
h1 + p::-webkit-scrollbar{ height:0; }

/* i3/tmux-like tabs */
h1 + p a{
  display:inline-block;
  padding: 6px 10px;
  margin-right: 6px;

  color: var(--muted);
  border-bottom: 2px solid transparent;
}

h1 + p a:hover{
  color: var(--fg);
  border-bottom-color: var(--green);
}

/* “active” default hint */
h1 + p a:first-child{
  color: var(--fg);
  border-bottom-color: var(--green);
}

/* ---------- Section headers (h2 = titlebar) ---------- */

h2{
  margin: var(--section-gap) 0 10px 0;
  padding: 10px 12px;

  background: rgba(15,18,22,0.55);
  border: 1px solid var(--line);
  border-left: 4px solid var(--cyan);

  color: var(--cyan);
  font-size: 18px;
  font-weight: 800;
  letter-spacing: 0.09em;
  text-transform: uppercase;
}

/* Keep paragraphs sparse */
p{
  margin: 10px 0;
  color: var(--fg);
}
strong{ color: var(--green); }

/* Clojure-y pane decorations */
pre.example{
  border-left: 2px solid rgba(102,217,239,0.65); /* cyan spine */
}

pre.example .kv{
  /* add a subtle top stripe like a focused pane */
  box-shadow: inset 0 2px 0 rgba(253,151,31,0.35);
}

/* Key/value row feel: a faint separator line */
pre.example .kv{
  background: linear-gradient(to bottom, rgba(15,18,22,0.0), rgba(15,18,22,0.0));
}

pre.example .row{
  /* not actually used (display: contents), but keep for clarity */
}

/* Make keys look like Clojure keywords */
pre.example .k{
  color: var(--green);
  font-weight: 800;
}

/* Add a colon prefix to keys */
pre.example .k::before{
  content: ":";
  color: var(--cyan);
  margin-right: 2px;
  opacity: 0.95;
}

/* Add a subtle arrow separator between key and value */
pre.example .v::before{
  content: "  ";
}

pre.example .v{
  color: var(--fg);
}

/* Orange and pink usage */
pre.example .warn{
  color: var(--orange);
  font-weight: 700;
}

pre.example .bad{
  color: var(--pink);
  font-weight: 800;
}

/* Dim the separators a bit more */
pre.example .sep{
  color: var(--dim);
}

/* Make the modeline pop slightly with orange */
body > p:last-of-type{
  box-shadow: inset 0 2px 0 rgba(253,151,31,0.35);
}

/* Optional: make links in the workspace bar a bit more monokai */
h1 + p a:hover{
  border-bottom-color: var(--orange);
}
h1 + p a:first-child{
  border-bottom-color: var(--orange);
}


/* ---------- Example panes (Org #+begin_example) ----------
   slab.js rewrites pre.example into a grid of .k/.v rows.
*/

pre, pre.example{
  background: var(--block);
  border: 1px solid var(--line);
  margin: 12px 0 24px 0;

  font-family: var(--font);
  font-size: 14px;
  line-height: 1.5;

  overflow: hidden;
}

/* When transformed, we supply padding inside the grid */
pre.example { padding: 0; }
pre.example .kv{
  display: grid;
  grid-template-columns: 112px 1fr;
  gap: 8px 14px;
  padding: 14px 16px;
}
pre.example .row{ display: contents; }

pre.example .k{
  color: var(--green);
  font-weight: 800;
}

pre.example .v{
  color: var(--fg);
}

pre.example .sep{
  color: var(--dim);
  margin: 0 6px;
}

pre.example .warn{ color: var(--orange); }
pre.example .bad{ color: var(--pink); }
pre.example .muted{ color: var(--muted); }

/* Make panes scroll horizontally only if needed */
pre.example .kv{
  overflow-x: auto;
}

/* ---------- Modeline (last paragraph) ---------- */

body > p:last-of-type{
  position: fixed;
  left:0; right:0; bottom:0;
  z-index: 200;

  margin:0;
  height: var(--modeline-h);
  display:flex;
  align-items:center;

  padding: 0 calc(var(--padx) + env(safe-area-inset-left));
  background: rgba(16,19,23,0.98);
  border-top: 1px solid var(--line);

  font-size: 14px;
  font-weight: 700;
  letter-spacing: 0.03em;
  color: var(--fg);
}

/* subtle divider line under bars (WM plane separation) */
body::before{
  content:"";
  position: fixed;
  left:0; right:0;
  top: calc(var(--topbar-h) + var(--workbar-h));
  height: 1px;
  background: rgba(28,33,40,0.45);
  z-index: 185;
}
