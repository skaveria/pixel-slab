{"version":3,"sources":["pixelSlab/compositor.cljs"],"mappings":"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","names":["pixelSlab.compositor/poll-ms","pixelSlab.compositor/token-test","cljs.core/re-pattern","pixelSlab.compositor/token-repl","pixelSlab.compositor/basename","s","or__5002__auto__","cljs.core/first","clojure.string.split","parts","cljs.core/last","pixelSlab.compositor/current-page-name","cljs.core._EQ_","js/location","p","pixelSlab.compositor/apply-template","tmpl","state","cljs.core/not","cljs.core/re-find","clojure.string/replace","p__7571","vec__7572","cljs.core.nth","_","k","v","pixelSlab.compositor/classify-value","t","clojure.string/lower-case","clojure.string/includes?","pixelSlab.compositor/split-kv","line","vec__7578","seq__7579","cljs.core/seq","first__7580","cljs.core/next","more","clojure.string/trim","clojure.string.join","temp__5804__auto__","vec__7581","cljs.core/re-matches","pixelSlab.compositor/append!","parent","child","pixelSlab.compositor/mk-span","cls","txt","el","js/document","pixelSlab.compositor/clear-children!","pixelSlab.compositor/state-val","fallback","pixelSlab.compositor/mk-seg","seg","k-el","v-el","klass","pixelSlab.compositor/highlight-active-tab!","bar","current","links","cljs.core.array_seq","seq__7596","chunk__7597","count__7598","i__7599","cljs.core/chunked-seq?","c__5525__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","a","match","cljs.core.filter","pixelSlab.compositor/ensure-modeline!","post","existing","modeline","d","pixelSlab.compositor/render-modeline!","m","nrepl","http","time","battery","volume","gitrev","sep-el","seq__7612","chunk__7613","count__7614","i__7615","pixelSlab.compositor/mount-pane!","pre","vec__7628","raw","clojure.string/trimr","lines","cljs.core.map","cljs.core.into","pane-type","clojure.string/starts-with?","cljs.core.subs","cljs.core.subvec","non-empty","p1__7624#","kv-pairs","cljs.core/some?","is-kv","x__5087__auto__","y__5088__auto__","js/Math.floor","kv","seq__7634","chunk__7635","count__7636","i__7637","vec__7656","vec__7664","row","kdiv","vdiv","pixelSlab.compositor/mount-all-panes!","seq__7667","chunk__7668","count__7669","i__7670","pixelSlab.compositor/render-panes!","seq__7692","chunk__7693","count__7694","i__7695","kind","seq__7713","chunk__7714","count__7715","i__7716","seq__7722","chunk__7723","count__7724","i__7725","rendered","pixelSlab.compositor/dev-state-override","x","js/window","and__5000__auto__","js/typeof","pixelSlab.compositor/fetch-state!","js/Promise.resolve","js/fetch","cljs.core/clj->js","res","pixelSlab.compositor/tick!","pixelSlab.compositor/init","js/setInterval"],"sourcesContent":["(ns pixelSlab.compositor\n  (:require [clojure.string :as str]))\n\n(def poll-ms 2500)\n\n(def token-test (re-pattern \"\\\\{\\\\{[a-zA-Z0-9_]+\\\\}\\\\}\"))\n(def token-repl (re-pattern \"\\\\{\\\\{([a-zA-Z0-9_]+)\\\\}\\\\}\"))\n\n(defn basename [s]\n  (let [s (or s \"\")\n        s (first (str/split s #\"[?#]\"))\n        parts (str/split s #\"/\")]\n    (or (last parts) \"index.html\")))\n\n(defn current-page-name []\n  (if (= \"file:\" (.-protocol js/location))\n    (basename (.-pathname js/location))\n    (let [p (.-pathname js/location)]\n      (if (or (nil? p) (= p \"/\")) \"index.html\" (basename p)))))\n\n(defn apply-template [tmpl state]\n  (let [tmpl (str tmpl)]\n    (if-not (re-find token-test tmpl)\n      tmpl\n      (str/replace tmpl token-repl\n                   (fn [[_ k]]\n                     (let [v (when state (aget state k))]\n                       (if (or (nil? v) (undefined? v)) \"\" (str v))))))))\n\n(defn classify-value [v]\n  (let [t (-> (str v) str/lower-case)]\n    (cond\n      (or (str/includes? t \"error\")\n          (str/includes? t \"failed\")\n          (str/includes? t \"offline\")\n          (str/includes? t \"down\")) \"bad\"\n      (or (str/includes? t \"warn\")\n          (str/includes? t \"charging\")\n          (str/includes? t \"dirty\")\n          (str/includes? t \"throttl\")\n          (str/includes? t \"hot\")) \"warn\"\n      :else \"\")))\n\n(defn split-kv [line]\n  (cond\n    (str/includes? line \"::\")\n    (let [[k & more] (str/split line #\"::\")]\n      [(str/trim k) (str/trim (str/join \"::\" more))])\n\n    :else\n    (when-let [[_ k v] (re-matches #\"^\\s*([^\\s]+)\\s{2,}(.+)$\" line)]\n      [(str/trim k) (str/trim v)])))\n\n;; ------------------------------------------------------------\n;; DOM helpers\n;; ------------------------------------------------------------\n\n(defn- append! [parent child]\n  (.appendChild parent child)\n  parent)\n\n(defn- mk-span [cls txt]\n  (let [el (.createElement js/document \"span\")]\n    (set! (.-className el) cls)\n    (set! (.-textContent el) (str txt))\n    el))\n\n(defn- clear-children! [el]\n  (set! (.-innerHTML el) \"\")\n  el)\n\n(defn- state-val [state k fallback]\n  (let [v (when state (aget state k))]\n    (if (or (nil? v) (undefined? v) (= \"\" (str v)))\n      fallback\n      (str v))))\n\n(defn- mk-seg\n  \"Create: <span class='seg'><span class='k'>..</span><span class='v ..'>..</span></span>\"\n  [k v]\n  (let [seg (.createElement js/document \"span\")\n        k-el (mk-span \"k\" k)\n        v-el (mk-span \"v\" v)\n        klass (classify-value v)]\n    (set! (.-className seg) \"seg\")\n    (when (seq klass)\n      (.. v-el -classList (add klass)))\n    (append! seg k-el)\n    (append! seg v-el)\n    seg))\n\n;; ------------------------------------------------------------\n;; Active tab highlight\n;; ------------------------------------------------------------\n\n(defn highlight-active-tab! []\n  (when-let [bar (.querySelector js/document \"h1 + p\")]\n    (let [current (current-page-name)\n          links (array-seq (.querySelectorAll bar \"a\"))]\n      (doseq [a links]\n        (.. a -classList (remove \"active\")))\n\n      (when-let [match (first (filter (fn [a]\n                                        (= (basename (.getAttribute a \"href\"))\n                                           current))\n                                      links))]\n        (.. match -classList (add \"active\")))\n\n      (when (and (= current \"index.html\")\n                 (seq links)\n                 (nil? (first (filter (fn [a]\n                                        (= (basename (.getAttribute a \"href\"))\n                                           current))\n                                      links))))\n        (.. (first links) -classList (add \"active\"))))))\n\n;; ------------------------------------------------------------\n;; Modeline (structured segments)\n;; ------------------------------------------------------------\n\n(defn- ensure-modeline! []\n  (when-let [post (.getElementById js/document \"postamble\")]\n    (let [existing (.getElementById js/document \"modeline\")\n          modeline (or existing\n                       (let [d (.createElement js/document \"div\")]\n                         (set! (.-id d) \"modeline\")\n                         (.appendChild post d)\n                         d))]\n      modeline)))\n\n(defn render-modeline! [state]\n  (when-let [m (ensure-modeline!)]\n    (clear-children! m)\n    (let [nrepl   (state-val state \"nrepl\" \"\u2014\")\n          http    (state-val state \"http\" \"\u2014\")\n          time    (state-val state \"time\" \"\u2014\")\n          battery (state-val state \"battery\" \"\u2014\")\n          volume  (state-val state \"volume\" \"\u2014\")\n          gitrev  (state-val state \"git_rev\" \"\u2014\")\n          sep-el  (fn [] (mk-span \"sep\" \"\u00b7\"))]\n\n      (append! m (mk-span \"node\" \"pixel-slab\"))\n\n      (doseq [seg [(sep-el) (mk-seg \":nrepl\" nrepl)\n                   (sep-el) (mk-seg \":http\" http)\n                   (sep-el) (mk-seg \":time\" time)\n                   (sep-el) (mk-seg \":battery\" battery)\n                   (sep-el) (mk-seg \":volume\" volume)\n                   (sep-el) (mk-seg \":git\" gitrev)]]\n        (append! m seg))))\n  nil)\n\n;; ------------------------------------------------------------\n;; Pane transform (unchanged from your working version)\n;; ------------------------------------------------------------\n\n(defn mount-pane! [pre]\n  (when-not (= \"1\" (.getAttribute pre \"data-slab-mounted\"))\n    (.setAttribute pre \"data-slab-mounted\" \"1\")\n\n    (let [raw (-> (.-textContent pre) (str/replace #\"\\r\\n\" \"\\n\") (str/trimr))\n          lines (->> (str/split raw #\"\\n\") (map str/trimr) (into []))\n          [pane-type lines] (if (and (seq lines) (str/starts-with? (first lines) \"@\"))\n                              [(-> (subs (first lines) 1) str/trim str/lower-case)\n                               (subvec lines 1)]\n                              [nil lines])\n          _ (when pane-type\n              (.. pre -classList (add (str \"pane-\" pane-type))))\n          non-empty (->> lines (filter #(seq (str/trim %))) (into []))\n          kv-pairs (->> non-empty (map split-kv) (filter some?) (into []))\n          is-kv (>= (count kv-pairs) (max 1 (js/Math.floor (* 0.7 (count non-empty)))))]\n\n      (if-not is-kv\n        (do\n          (.setAttribute pre \"data-pane-kind\" \"text\")\n          (.setAttribute pre \"data-template\" (str/join \"\\n\" lines)))\n        (do\n          (.setAttribute pre \"data-pane-kind\" \"kv\")\n          (.. pre -classList (add \"pane-kv\"))\n\n          (let [kv (.createElement js/document \"div\")]\n            (set! (.-className kv) \"kv\")\n\n            (doseq [[k v] kv-pairs]\n              (let [row (.createElement js/document \"div\")\n                    kdiv (.createElement js/document \"div\")\n                    vdiv (.createElement js/document \"div\")]\n                (set! (.-className row) \"row\")\n                (set! (.-className kdiv) \"k\")\n                (set! (.-textContent kdiv) k)\n\n                (set! (.-className vdiv) \"v\")\n                (.setAttribute vdiv \"data-template\" v)\n                (set! (.-textContent vdiv) v)\n\n                (.appendChild row kdiv)\n                (.appendChild row vdiv)\n                (.appendChild kv row)))\n\n            (set! (.-textContent pre) \"\")\n            (.appendChild pre kv)))))))\n\n(defn mount-all-panes! []\n  (doseq [pre (array-seq (.querySelectorAll js/document \"pre.example\"))]\n    (mount-pane! pre)))\n\n(defn render-panes! [state]\n  (doseq [pre (array-seq (.querySelectorAll js/document \"pre.example\"))]\n    (let [kind (.getAttribute pre \"data-pane-kind\")]\n      (cond\n        (= kind \"text\")\n        (let [tmpl (.getAttribute pre \"data-template\")]\n          (set! (.-textContent pre) (apply-template tmpl state)))\n\n        (= kind \"kv\")\n        (doseq [vdiv (array-seq (.querySelectorAll pre \".v\"))]\n          (let [tmpl (.getAttribute vdiv \"data-template\")\n                rendered (apply-template tmpl state)\n                klass (classify-value rendered)]\n            (set! (.-textContent vdiv) rendered)\n            (.. vdiv -classList (remove \"warn\"))\n            (.. vdiv -classList (remove \"bad\"))\n            (when (seq klass)\n              (.. vdiv -classList (add klass)))))))))\n\n(defn dev-state-override []\n  (let [x (aget js/window \"SLAB_STATE\")]\n    (when (and x (not (undefined? x)) (= \"object\" (js/typeof x))) x)))\n\n(defn fetch-state! []\n  (cond\n    (dev-state-override)\n    (js/Promise.resolve (dev-state-override))\n\n    (= \"file:\" (.-protocol js/location))\n    (js/Promise.resolve nil)\n\n    :else\n    (-> (js/fetch \"/api/state\" (clj->js {:cache \"no-store\"}))\n        (.then (fn [res] (if (.-ok res) (.json res) nil)))\n        (.catch (fn [_] nil)))))\n\n(defn tick! []\n  (highlight-active-tab!)\n  (mount-all-panes!)\n  (-> (fetch-state!)\n      (.then (fn [state]\n               (if state\n                 (do\n                   (render-panes! state)\n                   (render-modeline! state))\n                 (render-modeline! (clj->js {})))))))\n\n(defn init []\n  (tick!)\n  (js/setInterval tick! poll-ms))\n"]}